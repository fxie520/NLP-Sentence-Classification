#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Author: LiuHuan
# Datetime: 2020/1/12 17:05

import re


def zng(paragraph):
    for sent in re.findall(u'[^！？。]+[！？。]?', paragraph, flags=re.U):
        yield sent


def is_dotInSentence(Sentence, index):
    # 句中逗点，比如：带小数点的数字、缩略词等
    char_b1 = Sentence[index - 1]
    char_a1 = Sentence[index + 1]
    if ('0' <= char_b1 <= '9' or 'a' <= char_b1 <= 'z' or 'A' <= char_b1 <= 'Z') and (
            '0' <= char_a1 <= '9' or 'a' <= char_a1 <= 'z' or 'A' <= char_a1 <= 'Z' or char_a1 == '%' or char_a1 == ' ' or char_a1 == ')' or char_a1 == '）'):
        return True
    else:
        return False


def delete_tag(eachSentence):
    delete_first7_chars = (' 背景与目的:', ' 背景与目的：')
    delete_first6_chars = ('背景与目的:', '背景与目的：', ' 背景与目的')
    delete_first5_chars = ('背景与目的',
                           ' 【讨论】', ' 【简介】', ' 【背景】', ' 【目的】', ' 【方法】', ' 【结果】', ' 【结论】',
                           ' [讨论]', ' [简介]', ' [背景]', ' [目的]', ' [方法]', ' [结果]', ' [结论]')
    delete_first4_chars = ('【讨论】', '【简介】', '【背景】', '【目的】', '【方法】', '【结果】', '【结论】',
                           '[讨论]', '[简介]', '[背景]', '[目的]', '[方法]', '[结果]', '[结论]',
                           ' 讨论：', ' 简介：', ' 背景：', ' 目的：', ' 方法：', ' 结果：', ' 结论：',
                           ' 讨论:', ' 简介:', ' 背景:', ' 目的:', ' 方法:', ' 结果:', ' 结论:',
                           ' 讨论·', ' 简介·', ' 背景·', ' 目的·', ' 方法·', ' 结果·', ' 结论·')
    delete_first3_chars = ('讨论：', '简介：', '背景：', '目的：', '方法：', '结果：', '结论：',
                           '讨论:', '简介:', '背景:', '目的:', '方法:', '结果:', '结论:',
                           '讨论·', '简介·', '背景·', '目的·', '方法·', '结果·', '结论·',
                           ' 讨论', ' 简介', ' 背景', ' 目的', ' 方法', ' 结果', ' 结论', '目的 ', '方法 ', '结果 ', '结论 ')
    delete_first2_chars = ('简介', '背景', '目的', '方法', '结果', '结论')
    if eachSentence.startswith(delete_first7_chars):
        eachSentence = eachSentence[7:]
    if eachSentence.startswith(delete_first6_chars):
        eachSentence = eachSentence[6:]
    if eachSentence.startswith(delete_first5_chars):
        eachSentence = eachSentence[5:]
    if eachSentence.startswith(delete_first4_chars):
        eachSentence = eachSentence[4:]
    if eachSentence.startswith(delete_first3_chars):
        eachSentence = eachSentence[3:]
    if eachSentence.startswith(delete_first2_chars) and not eachSentence.startswith('结果表明'):
        eachSentence = eachSentence[2:]
    return eachSentence


def Seg_Sents_Cn(text):
    if '。' in text:
        seg_sents = []
        for sen in list(zng(text)):
            sen = delete_tag(sen)
            seg_sents.append(sen)
    else:
        text = text.replace('．', '.').strip()
        seg_sents = []
        indexs_of_dots = [index for index, x in enumerate(text) if x == '.']

        # 先去掉末尾点号
        for index in indexs_of_dots:
            if index == len(text) - 1:
                indexs_of_dots.remove(index)

        # 去掉句中点号
        for index in indexs_of_dots:
            if is_dotInSentence(text, index):
                indexs_of_dots.remove(index)

        if not indexs_of_dots:
            text = delete_tag(text)
            return [text]

        # 加入头尾index
        indexs_of_dots = [0] + indexs_of_dots + [len(text) - 1]

        # 按点号位置切分
        for i in range(len(indexs_of_dots) - 1):
            if i > 0:
                sen_temp = text[indexs_of_dots[i] + 1: indexs_of_dots[i + 1]] + '.'
            else:
                sen_temp = text[indexs_of_dots[i]:indexs_of_dots[i + 1]] + '.'
            # sen_temp = delete_tag(sen_temp)
            if '。' in sen_temp:
                for sen in list(zng(sen_temp)):
                    sen = delete_tag(sen)
                    seg_sents.append(sen)
            else:
                sen_temp = delete_tag(sen_temp)
                seg_sents.append(sen_temp)

    # print(seg_sents)
    return seg_sents


if __name__ == '__main__':
    # text = "双重频率锁定的腔衰荡吸收光谱技术及信号处理贾梦源赵刚侯佳佳谭巍邱晓东马维光张雷董磊尹王保肖连团贾锁堂2〃m波段高灵敏度离轴积分腔装置实际大气CO2测量High-sensitive off-axisintegrated cavity outputspectroscopy and itsmeasurementof ambientCO2at2〃m1.5〃m处CO2与CO高温线强的实验分析与理论计算Theoretical and experimental study on line intensitiesof CO2and CO transitionsnear1.5〃m athigh temperatures13CH4分子vs振动带空气和氮气加宽系数温度依赖性研究近三相点氮分子固体的低温红外吸收特性研究基于波长调制光谱技术的线宽测量理论及其应用研究双重频率锁定的腔衰荡吸收光谱技术及信号处理*贾梦源1）2）赵刚1）2）侯佳佳1）2）谭巍1）2）邱晓东1）2）马维光1）2汁张雷1）2）董磊1）2）尹王保1）2）肖连团1）2）贾锁堂1）2）1）（山西大学激光光谱研究所，量子光学与光量子器件国家重点实验室，太原030006）2）（山西大学，极端光学协同创新中心，太原030006）（2016年1月29日收到；2016年4月12日收到修改稿）针对传统腔衰荡光谱技术浓度获取率低，提出基于双重锁定的连续波腔衰荡吸收光谱技术.通过波长调制一次谐波信号将激光器的频率锁定到C2H2吸收线上，同时使用PDH锁频技术将衰荡腔锁定到激光器上,从而避免了测量过程中激光器的频率漂移和腔长的抖动，使测量结果更加精确；并且，由于双重锁定，单次衰荡事件的发生率，也就是浓度信息的获取率只受衰荡时间以及重新锁定时间限制，在本试验系统中采集速率可以达到30kHz,可以实现对气体浓度的快速测量.为了提高信噪比，采用Kalman滤波技术，对浓度信息进行实时处理，有效抑制了噪声，根据阿伦方差分析，探测灵敏度可以达到4X10-9cm-1（2s平均）。1引言气体检测在现实中具有多种意义：1）在环境方面，气体检测技术是掌握环境质量状况和发展趋势的重要手段[1];2）在工农业生产方面，过程气体的监测可以用于指导生产过程，提高生产效率，减少污染物排放⑵；3）在现代科技医疗领域，对呼出气体的检测可以用于病理学的分析[3〕.与传统的电化学、热导式等气体检测手段相比，新型的激光光谱技术具有高精度、高灵敏、无损伤、实时在线等优点,因此在近二十年得到了迅速发展.直接吸收光谱技术是最基本、最简单的激光光谱技术，其探测灵敏度通常只能达到10-3,很难满足痕量气体检测的要求.增长激光与被测气体的作用长度是提高探测灵敏度的有效手段之一,相关技术包括多通道池技术[4]、腔增强光谱技术（CEAS）I5〕、腔衰荡光谱技术（CRDS）等*8].腔衰荡光谱技术中使用高精细度腔大大增加了激光与气体介质相互作用的路径，通过测量腔内光强衰减时间反演气体浓度，由于测量的是时间信息，结果不受激光器强度噪声的影响，探测灵敏度可以达到10—9[6]。CRDS是在1988年由O’Keefe和Deacon[9〕首次提出的，他们使用脉冲激光器作为光源，测量了氧气的弱禁忌跃迁.1997年Romanini等[10〕提出了基于连续波的腔衰荡光谱技术（CW-CRDS）,连续激光器的使用克服了脉冲激光器频谱范围宽,重复性差等缺点，大大提高了腔衰荡光谱技术的t通信作者.E-mail：mwg@sxu.edu.cn测量灵敏度，然而衰荡腔和激光器的耦合通常是通过扫描激光器或者衰荡腔的腔长来实现的，扫描速率通常只能到kHz,衰荡时间的采样速率很低.为了提高衰荡事件的产生率，同时减少扫描CW-CRDS装置的腔长抖动，Paldus等［11〕在1998年提出了频率稳定的腔衰荡光谱技术(FS-CRDS),将腔的纵模锁定到激光上，衰荡事件的产生率只受衰荡时间以及重新锁定时间的限制，通常可以达到kHz,然而为了获得被测气体浓度，需要对气体吸收线进行扫描，对十几组衰荡时间进行线型拟合才能得到浓度结果，浓度的获取率较低，同时由于锁定带宽的限制，往往只能扫描低气压下的多普勒展宽或者使用阶梯式的扫描，大大限制了系统的应用［12］.2013年，Truong等［13〕提出了频率捷变的CRDS,将EOM的边带锁定到腔上，阶梯式变化EOM的调制频率(步长等于腔的自由光谱区)从而达到扫描吸收线的目的，浓度的获取速率可以达到8kHz,但是该方法需要使用一个窄线宽、超高速调谐的射频源，大大增加了系统的成本，不利于广泛推广.本文展示了一种周期性双重锁定的腔衰荡光谱系统，通过电光调制器，同时对激光施加频率为25和381MHz的双调制信号，使用波长调制一次谐波信号将激光器锁定在C2H2的吸收线中心,使用PDH方法再将腔长锁定到激光器上，避免了激光器频率的漂移和腔长的抖动［14，15〕.我们首先简单阐述了CRDS的原理，然后介绍了实验装置和实验过程，并且对双重锁定的效果进行了分析,最后为了进一步提高信噪比，使用了Kalman滤波器对浓度信号进行处理，有效提升了浓度的准确性［16-18］2腔衰荡光谱技术的原理在吸收光谱技术中，当初始光强为Tq的激光进入样品池，与吸收介质相互作用后，输出光强度减小为T,根据比尔朗伯定律，Tq与I存在以下关系：其中，a为介质吸收系数，L表示光与介质作用长度.吸收系数a正比于吸收线强度S、吸收线型X(v)、压强P以及介质浓度C,当介质浓度很低时,a会很小，可以通过增加光程L来提高探测灵敏度.CRDS技术利用两面高反镜使得光程大大增加(可达km),其原理如图1所示，进入腔内的光场在两高反镜片之间来回反射，由于腔镜的透射损耗以及腔内介质的吸收损耗(忽略腔镜以及吸收介质引入的散射、衍射等损耗)，在每一次往返过程中都有一定比例的光强衰减［19,20］.随着光波在腔内的振荡衰减，在腔的透射端可以探测到随指数衰减的光强信号，而光强衰减时间的变化反映了腔内吸收介质的浓度变化，它们的关系满足以下公式［21］:C=一二一(---)cSx(v)PL'ttq其中tq表示没有吸收介质时的衰荡时间，t表示存在吸收介质时的衰荡时间，c为光速［22］.最小可探测浓度AC可以根据以下公式计算：△t表示衰荡时间能够被精确测量的最小偏差.图1腔衰荡光谱技术原理图3实验装置双锁定的连续波腔衰荡光谱技术实验装置如图2所示.我们采用中心频率为1531nm的光纤激光器(KoherasAdjustik,E15PztS PM)作为光源，激光器波长可以通过施加在激光器压电陶瓷上的电压进行调谐.光纤声光调制器(FAOM,MT110-IIR20Fio-PM0.5-J1-A)和光纤电光调制器(FEOM,photline,MPX-LN-0.5)分别作为光学开关和频率调制模块,FAOM出射的一级衍射光经过FEOM调制，再通过1:9的光纤分束器，光强较弱的部分通过压强为50Torr(1Torr*133.32Pa),浓度为100%的C2H2标准吸收池用于激光频率到C2H2在6534.3634cm“1处吸收线的锁定［23,24］.光强较强的光束经过500mm匹配透镜，耦合到衰荡腔内，用于观测衰荡信号，腔的透射光被光电探测器3(PD3,THORLABS,PDA10CF-EC)探测后信号由数据采集卡(NI,PCI-6115)传送到电脑对衰荡信号进行监测和处理.图2(网刊彩色)实验装置图FG,信号发生器；FAOM,光纤声光调制器；FEOM,光纤电光调制器；PL,匹配透镜；LP,低通滤波器；PID,比例积分微分控制器；PD,光电探测器；PBS,偏振分光棱镜；HVA,高压放大器实验中的衰荡腔是由一对反射率均为99.9% 的平面镜和凹面镜(Layertec)组成的平凹腔，两镜面之间相隔39.4cm,凹面镜的曲率半径为1m,腔长可以通过固定在凹面镜上的环形低压压电陶瓷(PZT,PiezomechanikHPSt,150/20-15/25)进行调谐.腔体通过波纹管与真空泵(德国Leybold公司,PT50)和配气系统(莫尼特尔环境技术开发有限公司，BML-9550)连接，用于实验中气体浓度配比以及气压控制.实验中的双重锁定需要产生两个调制信号.一个信号发生器(FGi,NEW FOCUS,model3363)产生381MHz的射频，经过分束器施加到FEOM上,用于激光的调制，经过调制的光通过C2H2吸收池被探测器探测(PDi,THORLABS,PDA10CF-EC),再与参考信号进行混频、低通滤波，得到一次谐波解调信号作为误差信号送至比例积分控制器(PIDi,NEW FOCUS,LB1005servo controller),反馈到激光器的压电陶瓷上从而将激光器锁定到C2H2的吸收线上.另一个信号发生器(FG2,NEW FOCUS,model3363)产生25MHz的微波信号加载在FEOM上，用于PDH锁频，腔前镜的反射光，经过由偏振分光棱镜和四分之一波片组成的环形器，进入探测器(PD2,THORLABS,PDA10CF-EC),使用25MHz的参考信号对探测信号进行解调，将解调信号送至比例积分控制器(PID2,NEW FOCUS,LB1005servo controller),反馈到衰荡腔的压电陶瓷上，从而将衰荡腔锁定到激光器上.激光的关断由施加在FAOM驱动(AA opto-electronic,MODA110-B51K-34)上的方波信号控制，方波由信号发生器(FG3,TektronixAFG3022C)产生，为了采集完整的衰荡信号同时保证双重锁定的稳定，选取方波频率为30kHz,占空比为85%.实验过程中，光束被周期性地开关,C2H2的吸收线与激光器和衰荡腔被周期性地锁定,同时在腔后可以观测到周期性的衰荡事件.4实验过程及分析基于搭建的实验系统，我们首先将光纤激光器锁定到C2H2的6534.3634cm-1吸收线，对锁定前后的激光波长稳定性进行了比较，图3所示是对激光波长进行4h长期监测的结果，方块表示未锁定结果，圆点表示锁定结果.从图中可以看出，在未锁定的情况下，激光器的中心频率从6534.364cm-1漂移到6534.354cm-1,此时对应的吸收线型函数值x(v)将从23.4cm-1变为20.1cm-1,会对浓度的估计产生14%的误差，产生这种漂移主要是由于光纤激光器内部的压电陶瓷随着环境温度产生变化导致激光波长的漂移，而且这种漂移随着时间的增长会更加明显.而图3中圆点是将激光器锁定到吸收线中心后对波长长期监测的结果，可以看到4h内波长漂移量很小，保证了激光波长稳定在C2H2的吸收线中心.在确保激光器锁定到吸收线中心后，我们又使用PDH锁频技术将衰荡腔锁定到激光器上.图4用于说明PDH锁定效果.图4(a)是对腔长进行扫描，得到的腔透射信号，中间的信号突起部分说明此刻的腔与激光达到共振状态，激光在腔内大量积累；图4(b)是对腔前镜反射光进行解调得到的误差信号，为了减小由于激光偏振方向与FEOM非寻常轴不重合而引起的残余幅度调制现象(RAM),需要小心调节解调相位以减小误差信号的不对称性，图中误差信号平滑上下对称，为良好的锁定提供足够的反馈带宽，其中误差信号的中心对应图4(a)中透射线型的峰值，而两端的极值对应透射线型的半宽点，根据腔镜反射率可知腔模的半宽为60kHz,于是可以得到反馈频率与误差信号幅度之间的关系为60kHz/2.12V.图4(c)是锁定后的误差信号，信号在零点附近小范围起伏，信号幅度可以换算为相应的频率变化；图4(d)是对频率变化进行统计分布得到的直方图，图中曲线是进行高斯拟合的结果，可以知道腔到激光的锁定宽度为9.8kHz.图3(网刊彩色)激光器未锁定至6534.3634cm”1吸收线与锁定后波长长期测量结果11.2七。dojd图4(网刊彩色)将腔锁定到激光器上的锁定结果(a)未锁定时衰荡腔透射光；(b)腔模所对应的误差信号；(c)锁定后的误差信号；(d)对锁定后的误差信号进行频率分布分析在双重锁定的情况下，激光的频率被稳定在C2H2吸收线位置处，减小了激光的波长漂移，避免了测量过程中因激光频率抖动引起吸收系数减小的现象出现.同时腔模被锁定到了激光器中心频率处，激光可以持续泵入腔内，对比调谐模式下激光到衰荡腔的耦合方法，激光和衰荡腔一直处于耦合状态，采样速率不再取决于激光到衰荡腔的耦合速率，主要由衰荡时间以及激光与腔重新锁定所需时间决定，我们控制FAOM开关的函数发生器产生的方波频率为30kHz,占空比为85%,使每次衰荡事件发生过程完整，并且保证吸收线、激光、衰荡腔在光的开关之后仍然处于锁定状态，这样在测量不失真的情况下实现了衰荡时间的快速扫描.图5(a)和图5(b)分别是测量得到的FAOM驱动方波信号以及腔的透射信号，当驱动电压为正时，光路导通,激光、吸收线与腔共振，腔的透射端持续出射激光; 当驱动电压变为负时，光路关断，此时在腔的透射端观测到衰荡信号；当驱动电压重新开启时，双重反馈使得激光、吸收线与腔之间迅速锁定.其中，驱动电压和衰荡信号之间的延迟是由于FAOM及其驱动存在延时造成的.图6(a)是我们对空腔衰荡时间进行1min测量得到的结果.可以看出，空腔情况下的衰荡时间均值为1.394”，但是在锁定的情况下，曲线上仍然存在较大的噪声，影响实验测量的精确度.我们分析相关原因认为这是由电子噪声以及拟合过程存在误差引起的.图5(a)FAOM驱动方波；(b)腔透射信号结果以上这些误差都是系统装置固有的误差，很难通过实验手段对其进行抑制.为了减小实验结果的误差，我们使用了一种高效的软件滤波方法一一Kalman滤波器，来提高信噪比.Kalman滤波器用反馈控制的方法估计过程状态，以最小均方误差为最佳估计准则，采用信号与噪声的状态空间模型,利用前一时刻的估计值和当前时刻的观测值来更新对状态变量的估计，求出当前时刻的最优估计值，算法根据建立的系统方程和观测方程对需要处理的信号做出满足最小均方误差的估计.Kalman滤波的递推思想简单，所需要的数据存储量小，所需要的观测量数据小，因此不需要大量的存储空间，区别于传统的FIR滤波器,Kalman滤波器可以对数据进行实时处理，可以推广到非平稳随机过程，非常适合于连续采集分析的系统.Kalman滤波原理如图7所示，Xk_x/k_i表示上一状态的最优结果，Xk/k—\表示现在状态的最优结果，Kg是Kalman增益，表示测量值与估计值之间的权重，当前状态的最优结果与上一状态相关联，并影响下一状态的最优结果，只需要通过图中5个公式的计算，就得到实时的最优估计值.经过Kalman滤波的C2H2浓度信号如图6(b)所示，可以看出滤波结果不仅保留了原有的信号起伏，而且有效抑制了信号上的噪声，衰荡时间的标准偏差从0.00333提升为0.00153,根据(4)式可知对应最下可探测吸收浓度为32ppb(1ppb=1昭/L),根据阿伦方差分析，在2s平均的情况下，探测灵敏度可以达到4x10-9cm」1.图7Kalman滤波过程基于以上系统，我们对不同浓度下的C2H2气体进行了测量，使用配气系统对10ppm(1ppm=1mg/L)的C2H2以及纯N2进行不同的配比.配比浓度从100ppb到5ppm总共7个梯度，同时始终保持腔内气压为100Torr.每一个浓度值都做了1min的连续测量，测量结果如图8所示，可以看出测量结果稳定，且与配比浓度基本一致，很好地证明了系统对浓度变化的线性响应行为.同时可以看到随着浓度的增加，噪声也随之变大.这是由于随着浓度的增加，光在腔内的损耗也随着增加，使得衰荡时间变短，在浓度换算过程中放大了噪声.qdd>3s①.i切图8100ppb—5ppm浓度下C2H2的测量结果Fig.8.Measurementresultsof C2H2under100ppb—5ppmconcentration.5结论CW-CRDS技术通过增加激光与吸收物质的相互作用长度从而提高探测灵敏度，其精度高、实验装置简单，可应用于气体检测、镜面反射率测量等多领域.基于CW-CRDS的基本装置，我们通过双重锁定技术，将介质的吸收线、激光器和光学腔同时锁定在了一起，减小了测量过程中腔长抖动现象，避免了激光器中心频率相对于吸收线的漂移，提高了测量精度，将探测灵敏度提升到4x10-9cm-1.同时相对于调谐方式控制激光与光学腔的耦合装置，我们提高了光学腔和激光的耦合速率，实现了对气体浓度的快速采集.Phys.18660(in Chinese)[裴世鑫，高晓明，崔芬萍，黄伟,杨颙，邵杰，黄腾，赵卫雄，张为俊2005化学物理学报18660]"
    # text = "双重频率锁定的腔衰荡吸收光谱技术及信号处理贾梦源赵刚侯佳佳谭巍邱晓东马维光张雷董磊尹王保肖连团贾锁堂2〃m波段高灵敏度离轴积分腔装置实际大气CO2测量High-sensitive off-axisintegrated cavity outputspectroscopy and itsmeasurementof ambientCO2at2〃m1.5〃m处CO2与CO高温线强的实验分析与理论计算Theoretical and experimental study on line intensitiesof CO2and CO transitionsnear1.5〃m athigh temperatures13CH4分子vs振动带空气和氮气加宽系数温度依赖性研究近三相点氮分子固体的低温红外吸收特性研究基于波长调制光谱技术的线宽测量理论及其应用研究双重频率锁定的腔衰荡吸收光谱技术及信号处理*贾梦源1）2）赵刚1）2）侯佳佳1）2）谭巍1）2）邱晓东1）2）马维光1）2汁张雷1）2）董磊1）2）尹王保1）2）肖连团1）2）贾锁堂1）2）1）（山西大学激光光谱研究所，量子光学与光量子器件国家重点实验室，太原030006）2）（山西大学，极端光学协同创新中心，太原030006）（2016年1月29日收到；2016年4月12日收到修改稿）针对传统腔衰荡光谱技术浓度获取率低，提出基于双重锁定的连续波腔衰荡吸收光谱技术.通过波长调制一次谐波信号将激光器的频率锁定到C2H2吸收线上，同时使用PDH锁频技术将衰荡腔锁定到激光器上,从而避免了测量过程中激光器的频率漂移和腔长的抖动，使测量结果更加精确；并且，由于双重锁定，单次衰荡事件的发生率，也就是浓度信息的获取率只受衰荡时间以及重新锁定时间限制，在本试验系统中采集速率可以达到30kHz,可以实现对气体浓度的快速测量.为了提高信噪比，采用Kalman滤波技术，对浓度信息进行实时处理，有效抑制了噪声，根据阿伦方差分析，探测灵敏度可以达到4X10-9cm-1（2s平均）.1引言气体检测在现实中具有多种意义：1）在环境方面，气体检测技术是掌握环境质量状况和发展趋势的重要手段[1];2）在工农业生产方面，过程气体的监测可以用于指导生产过程，提高生产效率，减少污染物排放⑵；3）在现代科技医疗领域，对呼出气体的检测可以用于病理学的分析[3〕.与传统的电化学、热导式等气体检测手段相比，新型的激光光谱技术具有高精度、高灵敏、无损伤、实时在线等优点,因此在近二十年得到了迅速发展.直接吸收光谱技术是最基本、最简单的激光光谱技术，其探测灵敏度通常只能达到10-3,很难满足痕量气体检测的要求.增长激光与被测气体的作用长度是提高探测灵敏度的有效手段之一,相关技术包括多通道池技术[4]、腔增强光谱技术（CEAS）I5〕、腔衰荡光谱技术（CRDS）等*8].腔衰荡光谱技术中使用高精细度腔大大增加了激光与气体介质相互作用的路径，通过测量腔内光强衰减时间反演气体浓度，由于测量的是时间信息，结果不受激光器强度噪声的影响，探测灵敏度可以达到10—9[6].CRDS是在1988年由O’Keefe和Deacon[9〕首次提出的，他们使用脉冲激光器作为光源，测量了氧气的弱禁忌跃迁.1997年Romanini等[10〕提出了基于连续波的腔衰荡光谱技术（CW-CRDS）,连续激光器的使用克服了脉冲激光器频谱范围宽,重复性差等缺点，大大提高了腔衰荡光谱技术的t通信作者.E-mail：mwg@sxu.edu.cn测量灵敏度，然而衰荡腔和激光器的耦合通常是通过扫描激光器或者衰荡腔的腔长来实现的，扫描速率通常只能到kHz,衰荡时间的采样速率很低.为了提高衰荡事件的产生率，同时减少扫描CW-CRDS装置的腔长抖动，Paldus等［11〕在1998年提出了频率稳定的腔衰荡光谱技术(FS-CRDS),将腔的纵模锁定到激光上，衰荡事件的产生率只受衰荡时间以及重新锁定时间的限制，通常可以达到kHz,然而为了获得被测气体浓度，需要对气体吸收线进行扫描，对十几组衰荡时间进行线型拟合才能得到浓度结果，浓度的获取率较低，同时由于锁定带宽的限制，往往只能扫描低气压下的多普勒展宽或者使用阶梯式的扫描，大大限制了系统的应用［12］.2013年，Truong等［13〕提出了频率捷变的CRDS,将EOM的边带锁定到腔上，阶梯式变化EOM的调制频率(步长等于腔的自由光谱区)从而达到扫描吸收线的目的，浓度的获取速率可以达到8kHz,但是该方法需要使用一个窄线宽、超高速调谐的射频源，大大增加了系统的成本，不利于广泛推广.本文展示了一种周期性双重锁定的腔衰荡光谱系统，通过电光调制器，同时对激光施加频率为25和381MHz的双调制信号，使用波长调制一次谐波信号将激光器锁定在C2H2的吸收线中心,使用PDH方法再将腔长锁定到激光器上，避免了激光器频率的漂移和腔长的抖动［14，15〕.我们首先简单阐述了CRDS的原理，然后介绍了实验装置和实验过程，并且对双重锁定的效果进行了分析,最后为了进一步提高信噪比，使用了Kalman滤波器对浓度信号进行处理，有效提升了浓度的准确性［16-18］2腔衰荡光谱技术的原理在吸收光谱技术中，当初始光强为Tq的激光进入样品池，与吸收介质相互作用后，输出光强度减小为T,根据比尔朗伯定律，Tq与I存在以下关系：其中，a为介质吸收系数，L表示光与介质作用长度.吸收系数a正比于吸收线强度S、吸收线型X(v)、压强P以及介质浓度C,当介质浓度很低时,a会很小，可以通过增加光程L来提高探测灵敏度.CRDS技术利用两面高反镜使得光程大大增加(可达km),其原理如图1所示，进入腔内的光场在两高反镜片之间来回反射，由于腔镜的透射损耗以及腔内介质的吸收损耗(忽略腔镜以及吸收介质引入的散射、衍射等损耗)，在每一次往返过程中都有一定比例的光强衰减［19,20］.随着光波在腔内的振荡衰减，在腔的透射端可以探测到随指数衰减的光强信号，而光强衰减时间的变化反映了腔内吸收介质的浓度变化，它们的关系满足以下公式［21］:C=一二一(---)cSx(v)PL'ttq其中tq表示没有吸收介质时的衰荡时间，t表示存在吸收介质时的衰荡时间，c为光速［22］.最小可探测浓度AC可以根据以下公式计算：△t表示衰荡时间能够被精确测量的最小偏差.图1腔衰荡光谱技术原理图3实验装置双锁定的连续波腔衰荡光谱技术实验装置如图2所示.我们采用中心频率为1531nm的光纤激光器(KoherasAdjustik,E15PztS PM)作为光源，激光器波长可以通过施加在激光器压电陶瓷上的电压进行调谐.光纤声光调制器(FAOM,MT110-IIR20Fio-PM0.5-J1-A)和光纤电光调制器(FEOM,photline,MPX-LN-0.5)分别作为光学开关和频率调制模块,FAOM出射的一级衍射光经过FEOM调制，再通过1:9的光纤分束器，光强较弱的部分通过压强为50Torr(1Torr*133.32Pa),浓度为100%的C2H2标准吸收池用于激光频率到C2H2在6534.3634cm“1处吸收线的锁定［23,24］.光强较强的光束经过500mm匹配透镜，耦合到衰荡腔内，用于观测衰荡信号，腔的透射光被光电探测器3(PD3,THORLABS,PDA10CF-EC)探测后信号由数据采集卡(NI,PCI-6115)传送到电脑对衰荡信号进行监测和处理.图2(网刊彩色)实验装置图FG,信号发生器；FAOM,光纤声光调制器；FEOM,光纤电光调制器；PL,匹配透镜；LP,低通滤波器；PID,比例积分微分控制器；PD,光电探测器；PBS,偏振分光棱镜；HVA,高压放大器实验中的衰荡腔是由一对反射率均为99.9% 的平面镜和凹面镜(Layertec)组成的平凹腔，两镜面之间相隔39.4cm,凹面镜的曲率半径为1m,腔长可以通过固定在凹面镜上的环形低压压电陶瓷(PZT,PiezomechanikHPSt,150/20-15/25)进行调谐.腔体通过波纹管与真空泵(德国Leybold公司,PT50)和配气系统(莫尼特尔环境技术开发有限公司，BML-9550)连接，用于实验中气体浓度配比以及气压控制.实验中的双重锁定需要产生两个调制信号.一个信号发生器(FGi,NEW FOCUS,model3363)产生381MHz的射频，经过分束器施加到FEOM上,用于激光的调制，经过调制的光通过C2H2吸收池被探测器探测(PDi,THORLABS,PDA10CF-EC),再与参考信号进行混频、低通滤波，得到一次谐波解调信号作为误差信号送至比例积分控制器(PIDi,NEW FOCUS,LB1005servo controller),反馈到激光器的压电陶瓷上从而将激光器锁定到C2H2的吸收线上.另一个信号发生器(FG2,NEW FOCUS,model3363)产生25MHz的微波信号加载在FEOM上，用于PDH锁频，腔前镜的反射光，经过由偏振分光棱镜和四分之一波片组成的环形器，进入探测器(PD2,THORLABS,PDA10CF-EC),使用25MHz的参考信号对探测信号进行解调，将解调信号送至比例积分控制器(PID2,NEW FOCUS,LB1005servo controller),反馈到衰荡腔的压电陶瓷上，从而将衰荡腔锁定到激光器上.激光的关断由施加在FAOM驱动(AA opto-electronic,MODA110-B51K-34)上的方波信号控制，方波由信号发生器(FG3,TektronixAFG3022C)产生，为了采集完整的衰荡信号同时保证双重锁定的稳定，选取方波频率为30kHz,占空比为85%.实验过程中，光束被周期性地开关,C2H2的吸收线与激光器和衰荡腔被周期性地锁定,同时在腔后可以观测到周期性的衰荡事件.4实验过程及分析基于搭建的实验系统，我们首先将光纤激光器锁定到C2H2的6534.3634cm-1吸收线，对锁定前后的激光波长稳定性进行了比较，图3所示是对激光波长进行4h长期监测的结果，方块表示未锁定结果，圆点表示锁定结果.从图中可以看出，在未锁定的情况下，激光器的中心频率从6534.364cm-1漂移到6534.354cm-1,此时对应的吸收线型函数值x(v)将从23.4cm-1变为20.1cm-1,会对浓度的估计产生14%的误差，产生这种漂移主要是由于光纤激光器内部的压电陶瓷随着环境温度产生变化导致激光波长的漂移，而且这种漂移随着时间的增长会更加明显.而图3中圆点是将激光器锁定到吸收线中心后对波长长期监测的结果，可以看到4h内波长漂移量很小，保证了激光波长稳定在C2H2的吸收线中心.在确保激光器锁定到吸收线中心后，我们又使用PDH锁频技术将衰荡腔锁定到激光器上.图4用于说明PDH锁定效果.图4(a)是对腔长进行扫描，得到的腔透射信号，中间的信号突起部分说明此刻的腔与激光达到共振状态，激光在腔内大量积累；图4(b)是对腔前镜反射光进行解调得到的误差信号，为了减小由于激光偏振方向与FEOM非寻常轴不重合而引起的残余幅度调制现象(RAM),需要小心调节解调相位以减小误差信号的不对称性，图中误差信号平滑上下对称，为良好的锁定提供足够的反馈带宽，其中误差信号的中心对应图4(a)中透射线型的峰值，而两端的极值对应透射线型的半宽点，根据腔镜反射率可知腔模的半宽为60kHz,于是可以得到反馈频率与误差信号幅度之间的关系为60kHz/2.12V.图4(c)是锁定后的误差信号，信号在零点附近小范围起伏，信号幅度可以换算为相应的频率变化；图4(d)是对频率变化进行统计分布得到的直方图，图中曲线是进行高斯拟合的结果，可以知道腔到激光的锁定宽度为9.8kHz.图3(网刊彩色)激光器未锁定至6534.3634cm”1吸收线与锁定后波长长期测量结果11.2七。dojd图4(网刊彩色)将腔锁定到激光器上的锁定结果(a)未锁定时衰荡腔透射光；(b)腔模所对应的误差信号；(c)锁定后的误差信号；(d)对锁定后的误差信号进行频率分布分析在双重锁定的情况下，激光的频率被稳定在C2H2吸收线位置处，减小了激光的波长漂移，避免了测量过程中因激光频率抖动引起吸收系数减小的现象出现.同时腔模被锁定到了激光器中心频率处，激光可以持续泵入腔内，对比调谐模式下激光到衰荡腔的耦合方法，激光和衰荡腔一直处于耦合状态，采样速率不再取决于激光到衰荡腔的耦合速率，主要由衰荡时间以及激光与腔重新锁定所需时间决定，我们控制FAOM开关的函数发生器产生的方波频率为30kHz,占空比为85%,使每次衰荡事件发生过程完整，并且保证吸收线、激光、衰荡腔在光的开关之后仍然处于锁定状态，这样在测量不失真的情况下实现了衰荡时间的快速扫描.图5(a)和图5(b)分别是测量得到的FAOM驱动方波信号以及腔的透射信号，当驱动电压为正时，光路导通,激光、吸收线与腔共振，腔的透射端持续出射激光; 当驱动电压变为负时，光路关断，此时在腔的透射端观测到衰荡信号；当驱动电压重新开启时，双重反馈使得激光、吸收线与腔之间迅速锁定.其中，驱动电压和衰荡信号之间的延迟是由于FAOM及其驱动存在延时造成的.图6(a)是我们对空腔衰荡时间进行1min测量得到的结果.可以看出，空腔情况下的衰荡时间均值为1.394”，但是在锁定的情况下，曲线上仍然存在较大的噪声，影响实验测量的精确度.我们分析相关原因认为这是由电子噪声以及拟合过程存在误差引起的.图5(a)FAOM驱动方波；(b)腔透射信号结果以上这些误差都是系统装置固有的误差，很难通过实验手段对其进行抑制.为了减小实验结果的误差，我们使用了一种高效的软件滤波方法一一Kalman滤波器，来提高信噪比.Kalman滤波器用反馈控制的方法估计过程状态，以最小均方误差为最佳估计准则，采用信号与噪声的状态空间模型,利用前一时刻的估计值和当前时刻的观测值来更新对状态变量的估计，求出当前时刻的最优估计值，算法根据建立的系统方程和观测方程对需要处理的信号做出满足最小均方误差的估计.Kalman滤波的递推思想简单，所需要的数据存储量小，所需要的观测量数据小，因此不需要大量的存储空间，区别于传统的FIR滤波器,Kalman滤波器可以对数据进行实时处理，可以推广到非平稳随机过程，非常适合于连续采集分析的系统.Kalman滤波原理如图7所示，Xk_x/k_i表示上一状态的最优结果，Xk/k—\表示现在状态的最优结果，Kg是Kalman增益，表示测量值与估计值之间的权重，当前状态的最优结果与上一状态相关联，并影响下一状态的最优结果，只需要通过图中5个公式的计算，就得到实时的最优估计值.经过Kalman滤波的C2H2浓度信号如图6(b)所示，可以看出滤波结果不仅保留了原有的信号起伏，而且有效抑制了信号上的噪声，衰荡时间的标准偏差从0.00333提升为0.00153,根据(4)式可知对应最下可探测吸收浓度为32ppb(1ppb=1昭/L),根据阿伦方差分析，在2s平均的情况下，探测灵敏度可以达到4x10-9cm」1.图7Kalman滤波过程基于以上系统，我们对不同浓度下的C2H2气体进行了测量，使用配气系统对10ppm(1ppm=1mg/L)的C2H2以及纯N2进行不同的配比.配比浓度从100ppb到5ppm总共7个梯度，同时始终保持腔内气压为100Torr.每一个浓度值都做了1min的连续测量，测量结果如图8所示，可以看出测量结果稳定，且与配比浓度基本一致，很好地证明了系统对浓度变化的线性响应行为.同时可以看到随着浓度的增加，噪声也随之变大.这是由于随着浓度的增加，光在腔内的损耗也随着增加，使得衰荡时间变短，在浓度换算过程中放大了噪声.qdd>3s①.i切图8100ppb—5ppm浓度下C2H2的测量结果Fig.8.Measurementresultsof C2H2under100ppb—5ppmconcentration.5结论CW-CRDS技术通过增加激光与吸收物质的相互作用长度从而提高探测灵敏度，其精度高、实验装置简单，可应用于气体检测、镜面反射率测量等多领域.基于CW-CRDS的基本装置，我们通过双重锁定技术，将介质的吸收线、激光器和光学腔同时锁定在了一起，减小了测量过程中腔长抖动现象，避免了激光器中心频率相对于吸收线的漂移，提高了测量精度，将探测灵敏度提升到4x10-9cm-1.同时相对于调谐方式控制激光与光学腔的耦合装置，我们提高了光学腔和激光的耦合速率，实现了对气体浓度的快速采集.Phys.18660(in Chinese)[裴世鑫，高晓明，崔芬萍，黄伟,杨颙，邵杰，黄腾，赵卫雄，张为俊2005化学物理学报18660]"
    text = input()
    # text="双重频率锁定的腔衰荡吸收光谱技术及信号处理贾梦源赵刚侯佳佳谭巍邱晓东马维光张雷董磊尹王保肖连团贾锁堂2〃m波段高灵敏度离轴积分腔装置实际大气CO2测量High-sensitive off-axisintegrated cavity outputspectroscopy and itsmeasurementof ambientCO2at2〃m1.5〃m处CO2与CO高温线强的实验分析与理论计算Theoretical and experimental study on line intensitiesof CO2and CO transitionsnear1.5〃m athigh temperatures13CH4分子vs振动带空气和氮气加宽系数温度依赖性研究近三相点氮分子固体的低温红外吸收特性研究基于波长调制光谱技术的线宽测量理论及其应用研究双重频率锁定的腔衰荡吸收光谱技术及信号处理*贾梦源1）2）赵刚1）2）侯佳佳1）2）谭巍1）2）邱晓东1）2）马维光1）2汁张雷1）2）董磊1）2）尹王保1）2）肖连团1）2）贾锁堂1）2）1）（山西大学激光光谱研究所，量子光学与光量子器件国家重点实验室，太原030006）2）（山西大学，极端光学协同创新中心，太原030006）（2016年1月29日收到；2016年4月12日收到修改稿）针对传统腔衰荡光谱技术浓度获取率低，提出基于双重锁定的连续波腔衰荡吸收光谱技术.通过波长调制一次谐波信号将激光器的频率锁定到C2H2吸收线上，同时使用PDH锁频技术将衰荡腔锁定到激光器上,从而避免了测量过程中激光器的频率漂移和腔长的抖动，使测量结果更加精确；并且，由于双重锁定，单次衰荡事件的发生率，也就是浓度信息的获取率只受衰荡时间以及重新锁定时间限制，在本试验系统中采集速率可以达到30kHz,可以实现对气体浓度的快速测量.为了提高信噪比，采用Kalman滤波技术，对浓度信息进行实时处理，有效抑制了噪声，根据阿伦方差分析，探测灵敏度可以达到4X10-9cm-1（2s平均）.1引言气体检测在现实中具有多种意义：1）在环境方面，气体检测技术是掌握环境质量状况和发展趋势的重要手段[1];2）在工农业生产方面，过程气体的监测可以用于指导生产过程，提高生产效率，减少污染物排放⑵；3）在现代科技医疗领域，对呼出气体的检测可以用于病理学的分析[3〕.与传统的电化学、热导式等气体检测手段相比，新型的激光光谱技术具有高精度、高灵敏、无损伤、实时在线等优点,因此在近二十年得到了迅速发展.直接吸收光谱技术是最基本、最简单的激光光谱技术，其探测灵敏度通常只能达到10-3,很难满足痕量气体检测的要求.增长激光与被测气体的作用长度是提高探测灵敏度的有效手段之一,相关技术包括多通道池技术[4]、腔增强光谱技术（CEAS）I5〕、腔衰荡光谱技术（CRDS）等*8].腔衰荡光谱技术中使用高精细度腔大大增加了激光与气体介质相互作用的路径，通过测量腔内光强衰减时间反演气体浓度，由于测量的是时间信息，结果不受激光器强度噪声的影响，探测灵敏度可以达到10—9[6].CRDS是在1988年由O’Keefe和Deacon[9〕首次提出的，他们使用脉冲激光器作为光源，测量了氧气的弱禁忌跃迁.1997年Romanini等[10〕提出了基于连续波的腔衰荡光谱技术（CW-CRDS）,连续激光器的使用克服了脉冲激光器频谱范围宽,重复性差等缺点，大大提高了腔衰荡光谱技术的t通信作者.E-mail：mwg@sxu.edu.cn测量灵敏度，然而衰荡腔和激光器的耦合通常是通过扫描激光器或者衰荡腔的腔长来实现的，扫描速率通常只能到kHz,衰荡时间的采样速率很低.为了提高衰荡事件的产生率，同时减少扫描CW-CRDS装置的腔长抖动，Paldus等［11〕在1998年提出了频率稳定的腔衰荡光谱技术(FS-CRDS),将腔的纵模锁定到激光上，衰荡事件的产生率只受衰荡时间以及重新锁定时间的限制，通常可以达到kHz,然而为了获得被测气体浓度，需要对气体吸收线进行扫描，对十几组衰荡时间进行线型拟合才能得到浓度结果，浓度的获取率较低，同时由于锁定带宽的限制，往往只能扫描低气压下的多普勒展宽或者使用阶梯式的扫描，大大限制了系统的应用［12］.2013年，Truong等［13〕提出了频率捷变的CRDS,将EOM的边带锁定到腔上，阶梯式变化EOM的调制频率(步长等于腔的自由光谱区)从而达到扫描吸收线的目的，浓度的获取速率可以达到8kHz,但是该方法需要使用一个窄线宽、超高速调谐的射频源，大大增加了系统的成本，不利于广泛推广.本文展示了一种周期性双重锁定的腔衰荡光谱系统，通过电光调制器，同时对激光施加频率为25和381MHz的双调制信号，使用波长调制一次谐波信号将激光器锁定在C2H2的吸收线中心,使用PDH方法再将腔长锁定到激光器上，避免了激光器频率的漂移和腔长的抖动［14，15〕.我们首先简单阐述了CRDS的原理，然后介绍了实验装置和实验过程，并且对双重锁定的效果进行了分析,最后为了进一步提高信噪比，使用了Kalman滤波器对浓度信号进行处理，有效提升了浓度的准确性［16-18］2腔衰荡光谱技术的原理在吸收光谱技术中，当初始光强为Tq的激光进入样品池，与吸收介质相互作用后，输出光强度减小为T,根据比尔朗伯定律，Tq与I存在以下关系：其中，a为介质吸收系数，L表示光与介质作用长度.吸收系数a正比于吸收线强度S、吸收线型X(v)、压强P以及介质浓度C,当介质浓度很低时,a会很小，可以通过增加光程L来提高探测灵敏度.CRDS技术利用两面高反镜使得光程大大增加(可达km),其原理如图1所示，进入腔内的光场在两高反镜片之间来回反射，由于腔镜的透射损耗以及腔内介质的吸收损耗(忽略腔镜以及吸收介质引入的散射、衍射等损耗)，在每一次往返过程中都有一定比例的光强衰减［19,20］.随着光波在腔内的振荡衰减，在腔的透射端可以探测到随指数衰减的光强信号，而光强衰减时间的变化反映了腔内吸收介质的浓度变化，它们的关系满足以下公式［21］:C=一二一(---)cSx(v)PL'ttq其中tq表示没有吸收介质时的衰荡时间，t表示存在吸收介质时的衰荡时间，c为光速［22］.最小可探测浓度AC可以根据以下公式计算：△t表示衰荡时间能够被精确测量的最小偏差.图1腔衰荡光谱技术原理图3实验装置双锁定的连续波腔衰荡光谱技术实验装置如图2所示.我们采用中心频率为1531nm的光纤激光器(KoherasAdjustik,E15PztS PM)作为光源，激光器波长可以通过施加在激光器压电陶瓷上的电压进行调谐.光纤声光调制器(FAOM,MT110-IIR20Fio-PM0.5-J1-A)和光纤电光调制器(FEOM,photline,MPX-LN-0.5)分别作为光学开关和频率调制模块,FAOM出射的一级衍射光经过FEOM调制，再通过1:9的光纤分束器，光强较弱的部分通过压强为50Torr(1Torr*133.32Pa),浓度为100%的C2H2标准吸收池用于激光频率到C2H2在6534.3634cm“1处吸收线的锁定［23,24］.光强较强的光束经过500mm匹配透镜，耦合到衰荡腔内，用于观测衰荡信号，腔的透射光被光电探测器3(PD3,THORLABS,PDA10CF-EC)探测后信号由数据采集卡(NI,PCI-6115)传送到电脑对衰荡信号进行监测和处理.图2(网刊彩色)实验装置图FG,信号发生器；FAOM,光纤声光调制器；FEOM,光纤电光调制器；PL,匹配透镜；LP,低通滤波器；PID,比例积分微分控制器；PD,光电探测器；PBS,偏振分光棱镜；HVA,高压放大器实验中的衰荡腔是由一对反射率均为99.9% 的平面镜和凹面镜(Layertec)组成的平凹腔，两镜面之间相隔39.4cm,凹面镜的曲率半径为1m,腔长可以通过固定在凹面镜上的环形低压压电陶瓷(PZT,PiezomechanikHPSt,150/20-15/25)进行调谐.腔体通过波纹管与真空泵(德国Leybold公司,PT50)和配气系统(莫尼特尔环境技术开发有限公司，BML-9550)连接，用于实验中气体浓度配比以及气压控制.实验中的双重锁定需要产生两个调制信号.一个信号发生器(FGi,NEW FOCUS,model3363)产生381MHz的射频，经过分束器施加到FEOM上,用于激光的调制，经过调制的光通过C2H2吸收池被探测器探测(PDi,THORLABS,PDA10CF-EC),再与参考信号进行混频、低通滤波，得到一次谐波解调信号作为误差信号送至比例积分控制器(PIDi,NEW FOCUS,LB1005servo controller),反馈到激光器的压电陶瓷上从而将激光器锁定到C2H2的吸收线上.另一个信号发生器(FG2,NEW FOCUS,model3363)产生25MHz的微波信号加载在FEOM上，用于PDH锁频，腔前镜的反射光，经过由偏振分光棱镜和四分之一波片组成的环形器，进入探测器(PD2,THORLABS,PDA10CF-EC),使用25MHz的参考信号对探测信号进行解调，将解调信号送至比例积分控制器(PID2,NEW FOCUS,LB1005servo controller),反馈到衰荡腔的压电陶瓷上，从而将衰荡腔锁定到激光器上.激光的关断由施加在FAOM驱动(AA opto-electronic,MODA110-B51K-34)上的方波信号控制，方波由信号发生器(FG3,TektronixAFG3022C)产生，为了采集完整的衰荡信号同时保证双重锁定的稳定，选取方波频率为30kHz,占空比为85%."
    print(Seg_Sents_Cn(text))
