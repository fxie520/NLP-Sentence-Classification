CST 2021-03-16 19:52:19.908 - root - main.py - line 349 - INFO - Initializing:
CST 2021-03-16 19:52:19.909 - root - main.py - line 352 - INFO - Code being tested: False
CST 2021-03-16 19:52:19.909 - root - main.py - line 355 - INFO - "BertForSequenceClassification" model is used instead of the plain BERT model: False
CST 2021-03-16 19:52:19.909 - root - main.py - line 358 - INFO - Dataset: type 1 sentences
CST 2021-03-16 19:52:19.909 - root - main.py - line 364 - INFO - Tokenizer parallelization: true
CST 2021-03-16 19:52:21.363 - root - main.py - line 367 - INFO - CPU type: Intel(R) Xeon(R) CPU E5-2630L v3 @ 1.80GHz
CST 2021-03-16 19:52:22.270 - root - main.py - line 370 - INFO - Device: GeForce RTX 3090
CST 2021-03-16 19:52:22.271 - root - main.py - line 377 - INFO - Random seed: 42
CST 2021-03-16 19:52:22.315 - root - main.py - line 390 - INFO - Number of epochs: 4
CST 2021-03-16 19:52:22.316 - root - main.py - line 393 - INFO - 
CST 2021-03-16 19:52:22.316 - root - main.py - line 394 - INFO - Loading datasets:
CST 2021-03-16 19:52:22.380 - root - main.py - line 404 - INFO - Type 1 sentence ratio: 0.1525
CST 2021-03-16 19:52:22.381 - root - main.py - line 415 - INFO - Number of sentences used for training/validation/testing: 10000/5000/5000
CST 2021-03-16 19:52:22.381 - root - main.py - line 440 - INFO - Max length = 256
CST 2021-03-16 19:52:22.381 - root - main.py - line 443 - INFO - 
CST 2021-03-16 19:52:22.381 - root - main.py - line 444 - INFO - Grid search begins: 
CST 2021-03-16 19:52:22.381 - root - main.py - line 448 - INFO - Batch sizes: [32]
CST 2021-03-16 19:52:22.381 - root - main.py - line 449 - INFO - Initial learning rates: [2e-05]
CST 2021-03-16 19:52:22.381 - root - main.py - line 452 - INFO - Drop rates: 0.3
CST 2021-03-16 19:52:22.381 - root - main.py - line 454 - INFO - Xavier initialization: False
CST 2021-03-16 19:52:22.381 - root - main.py - line 456 - INFO - Hidden layer: None
CST 2021-03-16 19:52:26.342 - root - main.py - line 499 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-16 19:52:26.342 - root - main.py - line 500 - INFO - Batch size: 32, initial learning rate: 2e-05, total steps: 1252
CST 2021-03-16 19:52:26.342 - root - main.py - line 501 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-16 19:52:26.343 - root - main.py - line 509 - INFO - Epoch 1/4
CST 2021-03-16 19:53:58.287 - root - main.py - line 523 - INFO - Train loss 0.00394235071958974 accuracy 0.9597 f1 0.8650820220957482 precision 0.8916494133885439 recall 0.8400520156046815
CST 2021-03-16 19:54:12.535 - root - main.py - line 536 - INFO - Val loss 0.0018895655121421442 accuracy 0.9812 f1 0.9359673024523162 precision 0.9541666666666667 recall 0.9184491978609626
CST 2021-03-16 19:54:14.121 - root - main.py - line 509 - INFO - Epoch 2/4
CST 2021-03-16 19:55:45.065 - root - main.py - line 523 - INFO - Train loss 0.0013645674457249696 accuracy 0.9877 f1 0.9598694942903752 precision 0.9633267845448592 recall 0.9564369310793238
CST 2021-03-16 19:55:59.403 - root - main.py - line 536 - INFO - Val loss 0.001790797076083254 accuracy 0.9862 f1 0.9536601746138349 precision 0.9581646423751687 recall 0.9491978609625669
CST 2021-03-16 19:56:00.989 - root - main.py - line 509 - INFO - Epoch 3/4
CST 2021-03-16 19:57:31.601 - root - main.py - line 523 - INFO - Train loss 0.0006292193056287943 accuracy 0.9948 f1 0.9831278390655418 precision 0.9812176165803109 recall 0.9850455136540962
CST 2021-03-16 19:57:45.881 - root - main.py - line 536 - INFO - Val loss 0.001787630737919244 accuracy 0.9862 f1 0.9543952412425645 precision 0.9437908496732026 recall 0.9652406417112299
CST 2021-03-16 19:57:47.535 - root - main.py - line 509 - INFO - Epoch 4/4
CST 2021-03-16 19:59:17.923 - root - main.py - line 523 - INFO - Train loss 0.0002465128786046989 accuracy 0.9984 f1 0.9948018193632229 precision 0.9941558441558441 recall 0.9954486345903771
CST 2021-03-16 19:59:32.221 - root - main.py - line 536 - INFO - Val loss 0.00203828481840319 accuracy 0.988 f1 0.9600532623169108 precision 0.9562334217506632 recall 0.963903743315508
CST 2021-03-16 19:59:33.856 - root - main.py - line 553 - INFO - 
CST 2021-03-16 19:59:33.856 - root - main.py - line 554 - INFO - Best validation f1 0.9600532623169108 reached at epoch 4
CST 2021-03-16 19:59:33.856 - root - main.py - line 555 - INFO - Training time for 4 epochs: 7.125218041737875 min
CST 2021-03-16 19:59:33.856 - root - main.py - line 557 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-16 19:59:33.856 - root - main.py - line 558 - INFO - Grid search finished
CST 2021-03-16 19:59:33.856 - root - main.py - line 559 - INFO - Time consumed: 7.125218041737875 min
CST 2021-03-16 19:59:33.857 - root - main.py - line 560 - INFO - Validation f1 values [[0.96005326]] reached at epochs [[4.]] respectively
CST 2021-03-16 19:59:33.857 - root - main.py - line 562 - INFO - Best parameters: batch size = 32, learning rate = 2e-05, training epoch = 4
CST 2021-03-16 19:59:33.858 - root - main.py - line 565 - INFO - 
CST 2021-03-16 19:59:33.858 - root - main.py - line 566 - INFO - Loading best model: 
CST 2021-03-16 19:59:34.083 - root - main.py - line 572 - INFO - Testing model performance: 
CST 2021-03-16 19:59:48.342 - root - main.py - line 583 - INFO - Test accuracy 0.9864 f1 0.9553805774278215 precision 0.9578947368421052 recall 0.9528795811518325
CST 2021-03-16 20:00:02.464 - root - main.py - line 623 - INFO - 
CST 2021-03-16 20:00:02.464 - root - main.py - line 624 - INFO - Releasing GPU memory: 
CST 2021-03-16 20:00:02.752 - root - main.py - line 628 - INFO - GPU memory occupied: 0.0 gb
