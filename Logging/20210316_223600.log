CST 2021-03-16 22:36:00.318 - root - main.py - line 349 - INFO - Initializing:
CST 2021-03-16 22:36:00.319 - root - main.py - line 352 - INFO - Code being tested: False
CST 2021-03-16 22:36:00.319 - root - main.py - line 355 - INFO - "BertForSequenceClassification" model is used instead of the plain BERT model: False
CST 2021-03-16 22:36:00.319 - root - main.py - line 358 - INFO - Dataset: type 1 sentences
CST 2021-03-16 22:36:00.319 - root - main.py - line 364 - INFO - Tokenizer parallelization: true
CST 2021-03-16 22:36:01.773 - root - main.py - line 367 - INFO - CPU type: Intel(R) Xeon(R) CPU E5-2630L v3 @ 1.80GHz
CST 2021-03-16 22:36:01.834 - root - main.py - line 370 - INFO - Device: GeForce RTX 3090
CST 2021-03-16 22:36:01.834 - root - main.py - line 377 - INFO - Random seed: 42
CST 2021-03-16 22:36:01.873 - root - main.py - line 390 - INFO - Number of epochs: 4
CST 2021-03-16 22:36:01.873 - root - main.py - line 393 - INFO - 
CST 2021-03-16 22:36:01.873 - root - main.py - line 394 - INFO - Loading datasets:
CST 2021-03-16 22:36:01.927 - root - main.py - line 404 - INFO - Type 1 sentence ratio: 0.1525
CST 2021-03-16 22:36:01.927 - root - main.py - line 415 - INFO - Number of sentences used for training/validation/testing: 10000/5000/5000
CST 2021-03-16 22:36:01.927 - root - main.py - line 440 - INFO - Max length = 256
CST 2021-03-16 22:36:01.927 - root - main.py - line 443 - INFO - 
CST 2021-03-16 22:36:01.927 - root - main.py - line 444 - INFO - Grid search begins: 
CST 2021-03-16 22:36:01.927 - root - main.py - line 448 - INFO - Batch sizes: [32]
CST 2021-03-16 22:36:01.927 - root - main.py - line 449 - INFO - Initial learning rates: [7e-06]
CST 2021-03-16 22:36:01.928 - root - main.py - line 452 - INFO - Xavier initialization: False
CST 2021-03-16 22:36:01.928 - root - main.py - line 454 - INFO - Drop rates: [0.3, 0.5]
CST 2021-03-16 22:36:01.928 - root - main.py - line 456 - INFO - Hidden layer: 256
CST 2021-03-16 22:36:05.868 - root - main.py - line 499 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-16 22:36:05.868 - root - main.py - line 500 - INFO - Batch size: 32, initial learning rate: 7e-06, total steps: 1252
CST 2021-03-16 22:36:05.868 - root - main.py - line 501 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-16 22:36:05.868 - root - main.py - line 509 - INFO - Epoch 1/4
CST 2021-03-16 22:37:39.642 - root - main.py - line 523 - INFO - Train loss 0.0026352836401201786 accuracy 0.973 f1 0.9102990033222591 precision 0.9307065217391305 recall 0.8907672301690507
CST 2021-03-16 22:37:54.153 - root - main.py - line 536 - INFO - Val loss 0.0011695376165094785 accuracy 0.9898 f1 0.9656102494942683 precision 0.9741496598639455 recall 0.9572192513368984
CST 2021-03-16 22:37:55.729 - root - main.py - line 509 - INFO - Epoch 2/4
CST 2021-03-16 22:39:29.618 - root - main.py - line 523 - INFO - Train loss 0.0008768433343386277 accuracy 0.9924 f1 0.9753086419753086 precision 0.9746753246753247 recall 0.9759427828348505
CST 2021-03-16 22:39:44.163 - root - main.py - line 536 - INFO - Val loss 0.0015008508823171724 accuracy 0.99 f1 0.967018469656992 precision 0.9544270833333334 recall 0.9799465240641712
CST 2021-03-16 22:39:45.744 - root - main.py - line 509 - INFO - Epoch 3/4
CST 2021-03-16 22:41:18.467 - root - main.py - line 523 - INFO - Train loss 0.00043906691042939203 accuracy 0.9966 f1 0.9889466840052016 precision 0.9889466840052016 recall 0.9889466840052016
CST 2021-03-16 22:41:33.004 - root - main.py - line 536 - INFO - Val loss 0.0014876387174008413 accuracy 0.9914 f1 0.971504307488403 precision 0.9632063074901446 recall 0.9799465240641712
CST 2021-03-16 22:41:34.585 - root - main.py - line 509 - INFO - Epoch 4/4
CST 2021-03-16 22:43:07.574 - root - main.py - line 523 - INFO - Train loss 0.0002029604836119688 accuracy 0.9986 f1 0.9954397394136808 precision 0.9973890339425587 recall 0.9934980494148244
CST 2021-03-16 22:43:22.099 - root - main.py - line 536 - INFO - Val loss 0.0015259378518065205 accuracy 0.9912 f1 0.9708222811671088 precision 0.9631578947368421 recall 0.9786096256684492
CST 2021-03-16 22:43:22.100 - root - main.py - line 553 - INFO - 
CST 2021-03-16 22:43:22.100 - root - main.py - line 554 - INFO - Best validation f1 0.971504307488403 reached at epoch 3
CST 2021-03-16 22:43:22.100 - root - main.py - line 555 - INFO - Training time for 4 epochs: 7.270519495010376 min
CST 2021-03-16 22:43:22.100 - root - main.py - line 557 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-16 22:43:22.100 - root - main.py - line 558 - INFO - Grid search finished
CST 2021-03-16 22:43:22.100 - root - main.py - line 559 - INFO - Time consumed: 7.270519495010376 min
CST 2021-03-16 22:43:22.101 - root - main.py - line 560 - INFO - Validation f1 values [[0.97150431]] reached at epochs [[3.]] respectively
CST 2021-03-16 22:43:22.102 - root - main.py - line 562 - INFO - Best parameters: batch size = 32, learning rate = 7e-06, training epoch = 3
CST 2021-03-16 22:43:22.102 - root - main.py - line 565 - INFO - 
CST 2021-03-16 22:43:22.102 - root - main.py - line 566 - INFO - Loading best model: 
CST 2021-03-16 22:43:22.354 - root - main.py - line 572 - INFO - Testing model performance: 
CST 2021-03-16 22:43:36.887 - root - main.py - line 583 - INFO - Test accuracy 0.986 f1 0.9543676662320729 precision 0.9506493506493506 recall 0.9581151832460733
CST 2021-03-16 22:43:51.251 - root - main.py - line 623 - INFO - 
CST 2021-03-16 22:43:51.251 - root - main.py - line 624 - INFO - Releasing GPU memory: 
CST 2021-03-16 22:43:51.525 - root - main.py - line 628 - INFO - GPU memory occupied: 0.0 gb
