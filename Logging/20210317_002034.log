CST 2021-03-17 00:20:34.073 - root - main.py - line 349 - INFO - Initializing:
CST 2021-03-17 00:20:34.073 - root - main.py - line 352 - INFO - Code being tested: False
CST 2021-03-17 00:20:34.074 - root - main.py - line 355 - INFO - "BertForSequenceClassification" model is used instead of the plain BERT model: False
CST 2021-03-17 00:20:34.074 - root - main.py - line 358 - INFO - Dataset: type 1 sentences
CST 2021-03-17 00:20:34.074 - root - main.py - line 364 - INFO - Tokenizer parallelization: true
CST 2021-03-17 00:20:35.537 - root - main.py - line 367 - INFO - CPU type: Intel(R) Xeon(R) CPU E5-2630L v3 @ 1.80GHz
CST 2021-03-17 00:20:36.427 - root - main.py - line 370 - INFO - Device: GeForce RTX 3090
CST 2021-03-17 00:20:36.428 - root - main.py - line 377 - INFO - Random seed: 42
CST 2021-03-17 00:20:36.470 - root - main.py - line 390 - INFO - Number of epochs: 4
CST 2021-03-17 00:20:36.470 - root - main.py - line 393 - INFO - 
CST 2021-03-17 00:20:36.470 - root - main.py - line 394 - INFO - Loading datasets:
CST 2021-03-17 00:20:36.528 - root - main.py - line 404 - INFO - Type 1 sentence ratio: 0.1525
CST 2021-03-17 00:20:36.528 - root - main.py - line 415 - INFO - Number of sentences used for training/validation/testing: 10000/5000/5000
CST 2021-03-17 00:20:36.528 - root - main.py - line 440 - INFO - Max length = 256
CST 2021-03-17 00:20:36.528 - root - main.py - line 443 - INFO - 
CST 2021-03-17 00:20:36.529 - root - main.py - line 444 - INFO - Grid search begins: 
CST 2021-03-17 00:20:36.529 - root - main.py - line 448 - INFO - Batch sizes: [32]
CST 2021-03-17 00:20:36.529 - root - main.py - line 449 - INFO - Initial learning rates: [7e-06]
CST 2021-03-17 00:20:36.529 - root - main.py - line 452 - INFO - Xavier initialization: True
CST 2021-03-17 00:20:36.529 - root - main.py - line 454 - INFO - Drop rates: 0.3
CST 2021-03-17 00:20:36.529 - root - main.py - line 456 - INFO - Hidden layer: None
CST 2021-03-17 00:20:40.532 - root - main.py - line 499 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-17 00:20:40.532 - root - main.py - line 500 - INFO - Batch size: 32, initial learning rate: 7e-06, total steps: 1252
CST 2021-03-17 00:20:40.532 - root - main.py - line 501 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-17 00:20:40.532 - root - main.py - line 509 - INFO - Epoch 1/4
CST 2021-03-17 00:22:12.683 - root - main.py - line 523 - INFO - Train loss 0.002735847820994968 accuracy 0.9738 f1 0.9142108709888671 precision 0.920844327176781 recall 0.9076723016905072
CST 2021-03-17 00:22:26.938 - root - main.py - line 536 - INFO - Val loss 0.0012181396338826745 accuracy 0.9886 f1 0.9616161616161617 precision 0.9687924016282226 recall 0.9545454545454546
CST 2021-03-17 00:22:28.457 - root - main.py - line 509 - INFO - Epoch 2/4
CST 2021-03-17 00:23:59.577 - root - main.py - line 523 - INFO - Train loss 0.0009448288662664709 accuracy 0.9911 f1 0.9710945112049366 precision 0.9701492537313433 recall 0.9720416124837451
CST 2021-03-17 00:24:13.822 - root - main.py - line 536 - INFO - Val loss 0.001485524100640032 accuracy 0.9898 f1 0.9659773182121413 precision 0.9640479360852197 recall 0.9679144385026738
CST 2021-03-17 00:24:15.333 - root - main.py - line 509 - INFO - Epoch 3/4
CST 2021-03-17 00:25:46.196 - root - main.py - line 523 - INFO - Train loss 0.0005109514086736453 accuracy 0.9956 f1 0.9857328145265889 precision 0.9831824062095731 recall 0.988296488946684
CST 2021-03-17 00:26:00.467 - root - main.py - line 536 - INFO - Val loss 0.0016406402921908011 accuracy 0.9898 f1 0.9662921348314608 precision 0.9555555555555556 recall 0.9772727272727273
CST 2021-03-17 00:26:01.989 - root - main.py - line 509 - INFO - Epoch 4/4
CST 2021-03-17 00:27:32.507 - root - main.py - line 523 - INFO - Train loss 0.00029047728862660735 accuracy 0.9974 f1 0.9915529564652372 precision 0.990909090909091 recall 0.9921976592977894
CST 2021-03-17 00:27:46.785 - root - main.py - line 536 - INFO - Val loss 0.0016487367989659106 accuracy 0.9904 f1 0.9679572763684913 precision 0.9666666666666667 recall 0.9692513368983957
CST 2021-03-17 00:27:48.307 - root - main.py - line 553 - INFO - 
CST 2021-03-17 00:27:48.307 - root - main.py - line 554 - INFO - Best validation f1 0.9679572763684913 reached at epoch 4
CST 2021-03-17 00:27:48.307 - root - main.py - line 555 - INFO - Training time for 4 epochs: 7.1295674284299215 min
CST 2021-03-17 00:27:48.307 - root - main.py - line 557 - INFO - ----------------------------------------------------------------------------------------------------
CST 2021-03-17 00:27:48.307 - root - main.py - line 558 - INFO - Grid search finished
CST 2021-03-17 00:27:48.307 - root - main.py - line 559 - INFO - Time consumed: 7.1295674284299215 min
CST 2021-03-17 00:27:48.308 - root - main.py - line 560 - INFO - Validation f1 values [[0.96795728]] reached at epochs [[4.]] respectively
CST 2021-03-17 00:27:48.308 - root - main.py - line 562 - INFO - Best parameters: batch size = 32, learning rate = 7e-06, training epoch = 4
CST 2021-03-17 00:27:48.309 - root - main.py - line 565 - INFO - 
CST 2021-03-17 00:27:48.309 - root - main.py - line 566 - INFO - Loading best model: 
CST 2021-03-17 00:27:48.534 - root - main.py - line 572 - INFO - Testing model performance: 
CST 2021-03-17 00:28:02.767 - root - main.py - line 583 - INFO - Test accuracy 0.988 f1 0.9607843137254901 precision 0.9595300261096605 recall 0.9620418848167539
CST 2021-03-17 00:28:16.797 - root - main.py - line 623 - INFO - 
CST 2021-03-17 00:28:16.797 - root - main.py - line 624 - INFO - Releasing GPU memory: 
CST 2021-03-17 00:28:17.067 - root - main.py - line 628 - INFO - GPU memory occupied: 0.0 gb
